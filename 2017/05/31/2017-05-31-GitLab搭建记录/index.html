<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> GitLab搭建记录 · wkchen's blog</title><meta name="description" content="GitLab搭建记录 - wkchen"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://www.tipdev.xyz/atom.xml" title="wkchen's blog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">TIMELINE</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">GitLab搭建记录</h1><div class="post-info">May 31, 2017</div><div class="post-content"><p>​    居然花了半天时间搭建GitLab服务器，记得之前用自带的git建过服务器，几个人开发还能撑的过来，但是像公司这样几十个人同时开发的场景，就难以管理了。so，今天试了下GitLab的搭建。</p>
<blockquote>
<p>以下搭建环境：环境Centos 7</p>
</blockquote>
<h3 id="第一步：安装Git"><a href="#第一步：安装Git" class="headerlink" title="第一步：安装Git"></a>第一步：安装Git</h3><p>​    首先检查是否已经安装git</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">git --version</div><div class="line">git version 2.11.0 (Apple Git-81)</div><div class="line"></div><div class="line"><span class="comment"># 如果未安装</span></div><div class="line">sudo yum install git</div></pre></td></tr></table></figure>
<h3 id="第二步：安装依赖包"><a href="#第二步：安装依赖包" class="headerlink" title="第二步：安装依赖包"></a>第二步：安装依赖包</h3><figure class="highlight sh"><table><tr><td class="code"><pre><div class="line"><span class="comment"># 安装依赖</span></div><div class="line">sudo yum install curl openssh-server openssh-clients postfix cronie</div><div class="line"><span class="comment"># 启动邮件服务</span></div><div class="line">sudo service postfix start</div><div class="line"><span class="comment"># 检查 postfix</span></div><div class="line">sudo chkconfig postfix on</div></pre></td></tr></table></figure>
<h3 id="第三步：安装GitLab"><a href="#第三步：安装GitLab" class="headerlink" title="第三步：安装GitLab"></a>第三步：安装GitLab</h3><figure class="highlight sh"><table><tr><td class="code"><pre><div class="line"><span class="comment"># 添加国内镜像，新建/etc/yum.repos.d/gitlab-ce.repo 文件</span></div><div class="line">[gitlab-ce]</div><div class="line">name=gitlab-ce</div><div class="line">baseurl=http://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/yum/el6</div><div class="line">repo_gpgcheck=0</div><div class="line">gpgcheck=0</div><div class="line">enabled=1</div><div class="line">gpgkey=https://packages.gitlab.com/gpg.key</div><div class="line"></div><div class="line"><span class="comment"># 安装GitLab</span></div><div class="line">sudo yum install gitlab-ce</div><div class="line"><span class="comment"># 或</span></div><div class="line">sudo yum install gitlab-ce-8.5.7-ce.0.el6.x86_64(指定GitLab版本)</div><div class="line"><span class="comment"># 应用gitlab.rb配置</span></div><div class="line">sudo gitlab-ctl reconfigure</div></pre></td></tr></table></figure>
<h3 id="第四部：配置"><a href="#第四部：配置" class="headerlink" title="第四部：配置"></a>第四部：配置</h3><p>修改 vim /etc/gitlab/gitlab.rb 文件</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><div class="line"><span class="comment"># 如果需要用域名访问，请在hosts文件中做映射</span></div><div class="line">external_url <span class="string">'http://localhost:8800'</span></div><div class="line"></div><div class="line"><span class="comment"># unicorn 默认端口为8080，如果被占用就会报错502</span></div><div class="line">unicorn[<span class="string">'listen'</span>] = <span class="string">'127.0.0.1'</span></div><div class="line">unicorn[<span class="string">'port'</span>] = 8801</div></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="code"><pre><div class="line"><span class="comment"># 应用gitlab.rb配置</span></div><div class="line">sudo gitlab-ctl reconfigure</div></pre></td></tr></table></figure>
<h3 id="第五步：汉化"><a href="#第五步：汉化" class="headerlink" title="第五步：汉化"></a>第五步：汉化</h3><ol>
<li><p>检查GitLab版本</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">cat /opt/gitlab/embedded/service/gitlab-rails/VERSION</div></pre></td></tr></table></figure>
</li>
<li><p>克隆汉化包</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">git <span class="built_in">clone</span> https://gitlab.com/larryli/gitlab.git</div></pre></td></tr></table></figure>
</li>
<li><p>比对汉化补丁</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><div class="line"><span class="comment"># 注意汉化补丁要和GitLab版本对应，否则无法正常工作</span></div><div class="line"><span class="built_in">cd</span> gitlab/</div><div class="line"><span class="comment"># 建议先切换到8-5-zh分支下git checkout 8-5-zh，再进行操作</span></div><div class="line">sudo git diff origin/8-5-stable  8-5-zh &gt; /tmp/8.5.diff</div></pre></td></tr></table></figure>
</li>
<li><p>应用汉化补丁</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><div class="line"><span class="comment"># 先停止GitLab</span></div><div class="line">sudo gitlab-ctl stop</div><div class="line"><span class="comment"># 应用汉化补丁</span></div><div class="line"><span class="built_in">cd</span> /opt/gitlab/embedded/service/gitlab-rails</div><div class="line">git apply /tmp/8.5.diff  </div><div class="line"><span class="comment"># 启动GitLab</span></div><div class="line">sudo gitlab-ctl reconfigure</div><div class="line">sudo gitlab-ctl start</div></pre></td></tr></table></figure>
</li>
</ol>
<p>默认管理员账号</p>
<blockquote>
<p>账号：root</p>
<p>密码： 5iveL!fe</p>
</blockquote>
<p>最后，在浏览器输入服务器ip地址，或者你做映射对应的域名。</p>
</div></article></div></main><footer><div class="paginator"><a href="/2017/06/22/2017-06-22-服务端与客户端敏感数据通信的最佳实践/" class="prev">PREV</a><a href="/2017/05/23/2017-05-23-Android玩转View（二）搞懂View的滑动原理/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2017 <a href="http://www.tipdev.xyz">wkchen</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>